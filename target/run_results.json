{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.5", "generated_at": "2024-09-01T18:32:37.127046Z", "invocation_id": "55ae97fc-f9aa-4a70-9d3f-451a49a71b5b", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-09-01T18:32:37.048831Z", "completed_at": "2024-09-01T18:32:37.053660Z"}, {"name": "execute", "started_at": "2024-09-01T18:32:37.053836Z", "completed_at": "2024-09-01T18:32:37.118183Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06993317604064941, "adapter_response": {"_message": "SELECT 166", "code": "SELECT", "rows_affected": 166}, "message": "SELECT 166", "failures": null, "unique_id": "model.brightwheel.leads", "compiled": true, "compiled_code": "with salesforce_leads as (\n\n    select * from \"brightwheel\".\"brightwheel_exam\".\"salesforce_leads\" \n\n),\n\nsource1 as (\n\n    select * from \"brightwheel\".\"brightwheel_exam\".\"source1\"\n\n),\n\nsource2 as (\n\n    select * from \"brightwheel\".\"brightwheel_exam\".\"source2\"\n\n),\n\nsource3 as (\n\n    select * from \"brightwheel\".\"brightwheel_exam\".\"source3\"\n\n),\n\ncombined as (\n    select\n        'salesforce' as lead_type,\n        null as accepts_financial_aid,\n        null as max_age,\n        null as min_age,\n        capacity,\n        null as certificate_expiration_date,\n        city,\n        street as address1,\n        null as address2,\n        company,\n        phone,\n        mobile_phone as phone2,\n        null as county,\n        email,\n        first_name,\n        last_name,\n        null as license_status,\n        null as license_issued,\n        null as license_number,\n        null as license_type,\n        null as licensee_name,\n        brightwheel_school_uuid as provider_id,\n        null as schedule,\n        state,\n        title,\n        website as website_address,\n        postal_code as zip,\n        null as facility_type\n        \n    from salesforce_leads\n\n    union all\n\n    select\n        'source1' as lead_type,\n        null as accepts_financial_aid,\n        null as max_age,\n        null as min_age,\n        null as capacity,\n        expiration_date as certificate_expiration_date,\n        null as city,\n        address as address1,\n        null as address2,\n        name as company,\n        phone,\n        null as phone2,\n        county,\n        null as email,\n        split_part(primary_contact_name, ' ', 1) as first_name,\n        split_part(primary_contact_name, ' ', 2) as last_name,\n        status as license_status,\n        first_issue_date as license_issued,\n        credential_number as license_number,\n        credential_type as license_type,\n        primary_contact_name as licensee_name,\n        null as provider_id,\n        null as schedule,\n        state,\n        null as title,\n        null as website_address,\n        null as zip,\n        null as facility_type\n\n    from source1\n\n    union all\n\n    select\n        'source2' as lead_type,\n        accepts_subsidy as accepts_financial_aid,\n        case\n            when ages_accepted_4 = 'School-age (5 years-older)' or\n                ages_accepted_3 = 'School-age (5 years-older)' or\n                ages_accepted_2 = 'School-age (5 years-older)' or\n                ages_accepted_1 = 'School-age (5 years-older)'\n            then 'School'\n            when ages_accepted_4 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_3 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_2 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_1 = 'Preschool (24-48 months; 2-4 yrs.)'\n            then 'Preschool'\n            when ages_accepted_4 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_3 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_2 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_1 = 'Toddlers (12-23 months; 1yr.)'\n            then 'Toddler'\n            when ages_accepted_1 = 'Infants (0-11 months)' or\n                ages_accepted_2 = 'Infants (0-11 months)' \n                then 'Infant'\n        end as max_age,\n        case\n            when ages_accepted_1 = 'Infants (0-11 months)' or\n                ages_accepted_2 = 'Infants (0-11 months)' \n                then 'Infant'\n            when ages_accepted_4 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_3 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_2 = 'Toddlers (12-23 months; 1yr.)' or\n                ages_accepted_1 = 'Toddlers (12-23 months; 1yr.)'\n            then 'Toddler'\n            when ages_accepted_4 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_3 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_2 = 'Preschool (24-48 months; 2-4 yrs.)' or\n                ages_accepted_1 = 'Preschool (24-48 months; 2-4 yrs.)'\n            then 'Preschool'\n            when ages_accepted_4 = 'School-age (5 years-older)' or\n                ages_accepted_3 = 'School-age (5 years-older)' or\n                ages_accepted_2 = 'School-age (5 years-older)' or\n                ages_accepted_1 = 'School-age (5 years-older)'\n            then 'School'\n        end as min_age,\n        null as capacity,\n        null as certificate_expiration_date,\n        city,\n        address1,\n        address2,\n        company,\n        phone,\n        null as phone2,\n        null as county,\n        email,\n        split_part(primary_caregiver, ' ', 1) as first_name,\n        split_part(primary_caregiver, ' ', 2) as last_name,\n        null as license_status,\n        null as license_issued,\n        null as license_number,\n        type_license as license_type,\n        primary_caregiver as licensee_name,\n        null as provider_id,\n        year_round as schedule,\n        state,\n        null as title,\n        null as website_address,\n        zip,\n        null as facility_type\n\n    from source2\n\n    union all\n\n    select\n        'source3' as lead_type,\n        null as accepts_financial_aid,\n        case\n            when school = 'Y' then 'School'\n            when preschool = 'Y' then 'Preschool'\n            when toddler = 'Y' then 'Toddler'\n            when infant = 'Y' then 'Infant'\n        else null end as max_age,\n        case\n            when infant = 'Y' then 'Infant'\n            when toddler = 'Y' then 'Toddler'\n            when preschool = 'Y' then 'Preschool'\n            when school = 'Y' then 'School'\n        end as min_age,\n        capacity,\n        null as certificate_expiration_date,\n        city,\n        address as address1,\n        null as address2,\n        operation_name as company,\n        phone,\n        null as phone2,\n        county,\n        email_address as email,\n        null as first_name,\n        null as last_name,\n        status as license_status,\n        issue_date as license_issued,\n        facility_id as license_number,\n        type as license_type,\n        null as licensee_name,\n        facility_id as provider_id,\n        null as schedule,\n        state,\n        null as title,\n        null as website_address,\n        zip,\n        type as facility_type\n\n    from source3\n\n),\n\nfinal as (\n    select\n        lead_type,\n        accepts_financial_aid,\n        concat(concat(min_age, '-'), max_age) as ages_served,\n        capacity,\n        certificate_expiration_date,\n        city,\n        address1,\n        address2,\n        company,\n        phone,\n        phone2,\n        county,\n        email,\n        first_name,\n        last_name,\n        license_status,\n        license_issued,\n        license_number,\n        license_type,\n        licensee_name,\n        max_age,\n        min_age,\n        provider_id,\n        schedule,\n        state,\n        title,\n        website_address,\n        zip,\n        facility_type\n\n    from combined\n\n)\n\nselect * from final", "relation_name": "\"brightwheel\".\"brightwheel_exam\".\"leads\""}], "elapsed_time": 0.15899896621704102, "args": {"introspect": true, "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "log_format": "default", "require_resource_names_without_spaces": false, "log_level": "info", "profiles_dir": "/Users/paulfoote/.dbt", "select": ["leads"], "printer_width": 80, "source_freshness_run_project_hooks": false, "empty": false, "static_parser": true, "cache_selected_only": false, "macro_debugging": false, "partial_parse_file_diff": true, "project_dir": "/Users/paulfoote/Documents/dbt/brightwheel", "vars": {}, "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "invocation_command": "dbt run -m leads", "log_format_file": "debug", "show_resource_report": false, "strict_mode": false, "exclude": [], "which": "run", "log_path": "/Users/paulfoote/Documents/dbt/brightwheel/logs", "quiet": false, "version_check": true, "partial_parse": true, "write_json": true, "defer": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level_file": "debug", "send_anonymous_usage_stats": true, "use_colors": true, "use_colors_file": true, "populate_cache": true, "favor_state": false, "print": true}}